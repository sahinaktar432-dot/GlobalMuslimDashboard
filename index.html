<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Al-Alsa | Global Ummah</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@700&family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>

    <style>
        /* CORE RESET & VARIABLES */
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-font-smoothing: antialiased; -webkit-tap-highlight-color: transparent; }
        :root { --emerald: #043927; --gold: #c5a021; --bg: #f2f2f7; --white: #ffffff; }
        
        body { font-family: 'Inter', -apple-system, sans-serif; background: var(--bg); color: #121212; line-height: 1.25; overflow-x: hidden; }

        /* NAVBAR */
        nav { background: var(--emerald); padding: 14px 20px; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .logo { font-weight: 900; font-size: 1.4rem; letter-spacing: -1.2px; color: var(--gold); }

        /* FULL SCREEN PANELS */
        #fullMenu, #surahPanel, #quizPanel, #tasbihPanel {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--emerald); z-index: 5000; display: none; flex-direction: column;
            overflow-y: auto; padding: 40px 20px;
            opacity: 0; transform: translateY(30px);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .panel-active { display: flex !important; opacity: 1 !important; transform: translateY(0) !important; }

        /* PREMIUM MENU BUTTON STYLING (Google Style) */
        .pro-menu-btn {
            background: white; color: #444; padding: 18px; border-radius: 20px;
            font-size: 1.1rem; font-weight: 800; box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: flex; align-items: center; gap: 15px; margin-bottom: 15px;
            cursor: pointer; transition: transform 0.2s; border: none; width: 100%; text-decoration: none;
        }
        .pro-menu-btn:active { transform: scale(0.97); background: #f0f0f5; }
        .pro-menu-btn i { color: var(--emerald); font-size: 1.4rem; width: 30px; text-align: center; }
        .pro-menu-btn.google i { color: #4285F4; }
        .pro-menu-btn.logout { background: #ffe5e5; color: #d32f2f; }
        .pro-menu-btn.logout i { color: #d32f2f; }

        .close-btn { position: absolute; top: 20px; right: 30px; color: white; font-size: 2.5rem; cursor: pointer; z-index: 6000; }

        /* HERO SECTION */
        .hero { background: linear-gradient(180deg, var(--emerald) 0%, #0a5c41 100%); color: white; padding: 40px 20px; text-align: center; border-bottom-left-radius: 40px; border-bottom-right-radius: 40px; }
        .hero h1 { font-family: 'Amiri'; font-size: 2.8rem; color: var(--gold); margin-bottom: 5px; }
        .timer-row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 25px; }
        .timer-card { background: rgba(255,255,255,0.1); padding: 15px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.1); backdrop-filter: blur(5px); }
        .timer-card b { font-size: 1.1rem; color: var(--gold); display: block; font-weight: 900; margin-top: 5px; }

        /* SECTIONS & CONTAINERS */
        .container { padding: 20px; max-width: 650px; margin: 0 auto; margin-top: -30px; }
        section { background: var(--white); padding: 25px; border-radius: 28px; margin-bottom: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.06); }
        h2 { font-size: 1.3rem; font-weight: 900; color: var(--emerald); margin-bottom: 15px; letter-spacing: -0.5px; }

        /* PRAYER TIMES GRID (UPDATED) */
        .prayer-times-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .p-time-box {
            background: #fcfcfc; border: 1px solid #eee; padding: 15px 5px;
            border-radius: 18px; text-align: center;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
        }
        .p-time-box span { font-size: 0.75rem; font-weight: 800; color: #888; letter-spacing: 0.5px; margin-bottom: 5px; text-transform: uppercase; }
        .p-time-box b { font-size: 1.15rem; font-weight: 900; color: var(--emerald); font-family: 'Inter', sans-serif; }

        /* BUTTONS */
        .mission-btn, .quiz-opt { 
            width: 100%; padding: 18px; margin-bottom: 12px; border-radius: 20px; 
            border: 1px solid #eee; background: #f8f9fb; font-weight: 900; 
            color: var(--emerald); display: flex; justify-content: space-between; 
            align-items: center; cursor: pointer; transition: all 0.2s; 
        }
        .mission-btn:active, .quiz-opt:active { transform: scale(0.96); }
        .mission-btn.done { background: #34c759 !important; color: white !important; border-color: #34c759; box-shadow: 0 5px 15px rgba(52, 199, 89, 0.3); }

        /* 99 NAMES GRID */
        .names-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; }
        .name-box { background: #f8f9fa; padding: 15px; border-radius: 18px; border: 1px solid #eee; text-align: center; }
        .name-box .ar { font-family: 'Amiri'; font-size: 1.5rem; color: var(--emerald); display: block; margin-bottom: 5px; }
        .name-box .en { font-size: 0.8rem; font-weight: 800; color: var(--gold); text-transform: uppercase; }

        /* WISDOM SLIDEBAR */
        .quote-scroll { height: 400px; overflow-y: auto; padding-right: 5px; scrollbar-width: thin; scrollbar-color: var(--gold) #eee; }
        .q-card { padding: 20px; border-bottom: 1px solid #f0f0f0; border-left: 4px solid var(--gold); background: #fafafa; margin-bottom: 10px; border-radius: 0 15px 15px 0; }
        .q-card p { font-size: 1rem; font-weight: 700; color: #333; margin-bottom: 8px; line-height: 1.4; }
        .q-card span { font-size: 0.75rem; color: var(--emerald); font-weight: 900; text-transform: uppercase; }

        /* POPUPS */
        #coinFeedback { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 3rem; font-weight: 900; color: var(--gold); z-index: 7000; pointer-events: none; opacity: 0; }
        .animate-coin { animation: coinPop 0.8s ease-out forwards; }
        @keyframes coinPop { 0% { opacity: 0; transform: translate(-50%, 0); } 50% { opacity: 1; transform: translate(-50%, -100px); } 100% { opacity: 0; transform: translate(-50%, -150px); } }
        
        #comingSoonPopup {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.9);
            background: white; padding: 40px; border-radius: 30px; z-index: 9000;
            text-align: center; display: none; box-shadow: 0 30px 80px rgba(0,0,0,0.6);
            width: 85%; max-width: 400px; transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            opacity: 0;
        }
        #comingSoonPopup.active { transform: translate(-50%, -50%) scale(1); opacity: 1; }

        /* TASBIH & SURAHS */
        .surah-card { background: rgba(255,255,255,0.08); padding: 18px; border-radius: 22px; margin-bottom: 12px; color: white; border: 1px solid rgba(255,255,255,0.1); }
        .surah-info { display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px; }
        .surah-name-ar { font-family: 'Amiri'; font-size: 1.2rem; color: var(--gold); }
        audio { width: 100%; height: 35px; margin-top: 10px; filter: invert(1) hue-rotate(180deg); opacity: 0.8; }

        .tasbih-circle { 
            width: 240px; height: 240px; border: 12px solid var(--gold); border-radius: 50%; 
            margin: 40px auto; display: flex; align-items: center; justify-content: center; 
            font-size: 4rem; color: white; font-weight: 900; cursor: pointer; 
            box-shadow: 0 0 30px rgba(197, 160, 33, 0.3); user-select: none; 
        }
        .tasbih-circle:active { transform: scale(0.95); background: rgba(255,255,255,0.05); }

        /* LEADERBOARD TABLE */
        .leaderboard-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        .leaderboard-table tr { border-bottom: 1px solid #eee; }
        .leaderboard-table td { padding: 15px 5px; font-size: 0.95rem; font-weight: 700; }
        .rank-cell { font-weight: 900; font-size: 1.2rem; width: 40px; }

        /* FOOTER SOCIALS */
        .social-link { display: inline-flex; align-items: center; justify-content: center; width: 40px; height: 40px; background: #eee; border-radius: 50%; color: var(--emerald); font-size: 1.2rem; text-decoration: none; transition: 0.2s; }
        .social-link:active { transform: scale(0.9); background: var(--gold); color: white; }
    </style>
</head>
<body>

    <div id="coinFeedback">+1 ü™ô</div>

    <div id="comingSoonPopup">
        <i class="fas fa-tools" style="font-size: 4rem; color: var(--emerald); margin-bottom: 20px;"></i>
        <h2 style="color:var(--emerald); font-size: 1.5rem;">COMING SOON<br><span style="color:var(--gold); font-family:'Amiri';">INSHALLAH</span></h2>
        <p style="color:#666; margin-bottom: 25px; font-weight: 600;">We are working hard to bring this feature to the Ummah.</p>
        <button class="mission-btn" onclick="closeComingSoon()" style="justify-content:center; background: var(--emerald); color: white; border:none;">OKAY</button>
    </div>

    <nav>
        <div class="logo">AL-ALSA</div>
        <div style="display: flex; gap: 15px; align-items: center;">
            <div style="font-weight: 900; background: var(--gold); padding: 5px 12px; border-radius: 12px; font-size: 0.9rem;">ü™ô <span id="coinCount">0</span></div>
            <div onclick="toggleMenu()" style="color:white; cursor:pointer;"><i class="fas fa-bars-staggered" style="font-size: 1.5rem;"></i></div>
        </div>
    </nav>

    <div id="fullMenu">
        <div class="close-btn" onclick="toggleMenu()">√ó</div>
        
        <div id="userNameDisplay" style="color: var(--gold); font-size: 1.2rem; font-weight: 900; margin-bottom: 25px; text-align: center; text-transform: uppercase;"></div>

        <div id="loginBtn" class="pro-menu-btn google" onclick="handleGoogleLogin()">
            <i class="fab fa-google"></i> GOOGLE LOGIN
        </div>
        <div id="logoutBtn" class="pro-menu-btn logout" onclick="handleLogout()" style="display:none;">
            <i class="fas fa-sign-out-alt"></i> LOGOUT ACCOUNT
        </div>

        <hr style="border:0; border-top:1px solid rgba(255,255,255,0.2); margin: 20px 0;">

        <div class="pro-menu-btn" onclick="openTasbih()">
            <i class="fas fa-fingerprint"></i> DIGITAL TASBIH
        </div>
        <div class="pro-menu-btn" onclick="openSurahs()">
            <i class="fas fa-headphones-alt"></i> LISTEN SURAH
        </div>
        <div class="pro-menu-btn" onclick="openQuiz()">
            <i class="fas fa-brain"></i> ISLAMIC QUIZ
        </div>

        <hr style="border:0; border-top:1px solid rgba(255,255,255,0.2); margin: 20px 0;">

        <h3 style="color:rgba(255,255,255,0.6); font-size:0.9rem; margin-bottom:10px; padding-left:5px;">LEARNING HUB</h3>
        <div class="pro-menu-btn" onclick="showComingSoon()">
            <i class="fas fa-robot"></i> AI TUTOR
        </div>
        <div class="pro-menu-btn" onclick="showComingSoon()">
            <i class="fas fa-book-reader"></i> MEMORISE
        </div>
        <div class="pro-menu-btn" onclick="showComingSoon()">
            <i class="fas fa-trophy"></i> CHALLENGES
        </div>
    </div>

    <div id="surahPanel">
        <div class="close-btn" onclick="closeSurahs()">√ó</div>
        <h2 style="color: var(--gold); text-align: center; margin-bottom: 20px;">Noble Quran</h2>
        <div id="surahList"></div>
    </div>

    <div id="quizPanel">
        <div class="close-btn" onclick="closeQuiz()">√ó</div>
        <h2 style="color: var(--gold); text-align: center;">Quiz Challenge</h2>
        <div id="quizContent" style="margin-top: 30px;">
            <p id="questionText" style="color:white; font-size:1.3rem; font-weight:800; margin-bottom:20px; text-align:center;"></p>
            <div id="optionsContainer"></div>
        </div>
    </div>

    <div id="tasbihPanel">
        <div class="close-btn" onclick="closeTasbih()">√ó</div>
        <h2 style="color: var(--gold); text-align: center;">Digital Tasbih</h2>
        <p style="color: white; text-align: center; opacity: 0.8; margin-top: 10px;">Tap circle to count. Earn 1 coin per 33 Dhikr.</p>
        <div class="tasbih-circle" onclick="countTasbih()" id="tasbihDisplay">0</div>
        <button class="mission-btn" style="width: 150px; margin: 0 auto; background: var(--white); color: var(--emerald); justify-content: center;" onclick="resetTasbih()">RESET</button>
    </div>

    <div class="hero">
        <h1>ÿ®Ÿêÿ≥ŸíŸÖŸê ÿßŸÑŸÑŸáŸê</h1>
        <p style="font-weight: 900; text-transform: uppercase;">Global Muslim Dashboard</p>
        <div class="timer-row">
            <div class="timer-card"><small>RAMADAN 2026</small><b id="ramadan">--d --h</b></div>
            <div class="timer-card"><small>JUMMAH PRAYER</small><b id="jummah">--d --h</b></div>
        </div>
    </div>

    <div class="container">
        <section id="prayer-section">
            <h2 id="locationLabel">Prayer Times (Live)</h2>
            <div class="prayer-times-grid">
                <div class="p-time-box"><span>FAJR</span><b id="t-fajr">--:--</b></div>
                <div class="p-time-box"><span>DHUHR</span><b id="t-dhuhr">--:--</b></div>
                <div class="p-time-box"><span>ASR</span><b id="t-asr">--:--</b></div>
                <div class="p-time-box"><span>MAGHRIB</span><b id="t-maghrib">--:--</b></div>
                <div class="p-time-box"><span>ISHA</span><b id="t-isha">--:--</b></div>
                <div class="p-time-box"><span>SUNRISE</span><b id="t-sunrise">--:--</b></div>
            </div>
        </section>

        <section id="missions">
            <h2>Daily Salah Tracker</h2>
            <button class="mission-btn" id="salah-fajr" onclick="completeSalah('fajr', this)">FAJR <span>+1 ü™ô</span></button>
            <button class="mission-btn" id="salah-dhuhr" onclick="completeSalah('dhuhr', this)">DHUHR <span>+1 ü™ô</span></button>
            <button class="mission-btn" id="salah-asr" onclick="completeSalah('asr', this)">ASR <span>+1 ü™ô</span></button>
            <button class="mission-btn" id="salah-maghrib" onclick="completeSalah('maghrib', this)">MAGHRIB <span>+1 ü™ô</span></button>
            <button class="mission-btn" id="salah-isha" onclick="completeSalah('isha', this)">ISHA <span>+1 ü™ô</span></button>
        </section>

        <section id="leaderboard">
            <h2>Global Ummah Leaders üèÜ</h2>
            <table class="leaderboard-table" id="leaderboardBody"></table>
        </section>

        <section id="names">
            <h2>99 Names of Allah</h2>
            <div class="names-grid" id="namesGrid"></div>
        </section>

        <section id="quotes">
            <h2>100 Wisdoms & Verses</h2>
            <div class="quote-scroll" id="quoteList"></div>
        </section>
    </div>

    <footer style="text-align: center; padding: 40px 20px; border-top: 1px solid #eee;">
        <h2 style="color:var(--emerald)">AL-ALSA</h2>
        <p style="font-size: 0.8rem; font-weight: 800; opacity: 0.5; margin-bottom: 15px;">SHAHIN AKTAR ‚Ä¢ STUDENT DEVELOPER & EDITOR ‚Ä¢ 2026</p>
        
        <div style="display: flex; gap: 15px; justify-content: center;">
            <a href="https://www.linkedin.com/in/shahin-aktar-15b4a1272?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app" target="_blank" class="social-link"><i class="fab fa-linkedin-in"></i></a>
            <a href="mailto:business.aktar77@gmail.com" class="social-link"><i class="fas fa-envelope"></i></a>
        </div>
    </footer>

    <script>
        // 1. FIREBASE CONFIGURATION (EXACT MATCH)
        const firebaseConfig = { apiKey: "AIzaSyCUQblrFn3RHyy4sxqhA2Hz7Nq4gYosZT0", authDomain: "al-alsa.firebaseapp.com", databaseURL: "https://al-alsa-default-rtdb.firebaseio.com/", projectId: "al-alsa", storageBucket: "al-alsa.firebasestorage.app", messagingSenderId: "511589143545", appId: "1:511589143545:web:a3d4f7ec90afbda4cf2328", measurementId: "G-JL8FD6D6FF" };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.database();

        // 2. DATA CONSTANTS
        const surahNames = ["Al-Fatihah", "Al-Baqarah", "Ali 'Imran", "An-Nisa'", "Al-Ma'idah", "Al-An'am", "Al-A'raf", "Al-Anfal", "At-Tawbah", "Yunus", "Hud", "Yusuf", "Ar-Ra'd", "Ibrahim", "Al-Hijr", "An-Nahl", "Al-Isra'", "Al-Kahf", "Maryam", "Ta-Ha", "Al-Anbiya'", "Al-Hajj", "Al-Mu'minun", "An-Nur", "Al-Furqan", "Ash-Shu'ara'", "An-Naml", "Al-Qasas", "Al-'Ankabut", "Ar-Rum", "Luqman", "As-Sajdah", "Al-Ahzab", "Saba'", "Fatir", "Ya-Sin", "As-Saffat", "Sad", "Az-Zumar", "Ghafir", "Fussilat", "Ash-Shura", "Az-Zukhruf", "Ad-Dukhan", "Al-Jathiyah", "Al-Ahqaf", "Muhammad", "Al-Fath", "Al-Hujurat", "Qaf"];
        
        const allahNames = [
            {ar:"ÿßŸÑŸÑŸá", en:"Allah"}, {ar:"ÿßŸÑÿ±ÿ≠ŸÖŸÜ", en:"Ar-Rahman"}, {ar:"ÿßŸÑÿ±ÿ≠ŸäŸÖ", en:"Ar-Rahim"}, {ar:"ÿßŸÑŸÖŸÑŸÉ", en:"Al-Malik"}, {ar:"ÿßŸÑŸÇÿØŸàÿ≥", en:"Al-Quddus"}, {ar:"ÿßŸÑÿ≥ŸÑÿßŸÖ", en:"As-Salam"}, {ar:"ÿßŸÑŸÖÿ§ŸÖŸÜ", en:"Al-Mu'min"}, {ar:"ÿßŸÑŸÖŸáŸäŸÖŸÜ", en:"Al-Muhaymin"}, {ar:"ÿßŸÑÿπÿ≤Ÿäÿ≤", en:"Al-Aziz"}, {ar:"ÿßŸÑÿ¨ÿ®ÿßÿ±", en:"Al-Jabbar"}, {ar:"ÿßŸÑŸÖÿ™ŸÉÿ®ÿ±", en:"Al-Mutakabbir"}, {ar:"ÿßŸÑÿÆÿßŸÑŸÇ", en:"Al-Khaliq"}, {ar:"ÿßŸÑÿ®ÿßÿ±ÿ¶", en:"Al-Bari"}, {ar:"ÿßŸÑŸÖÿµŸàÿ±", en:"Al-Musawwir"}, {ar:"ÿßŸÑÿ∫ŸÅÿßÿ±", en:"Al-Ghaffar"}, {ar:"ÿßŸÑŸÇŸáÿßÿ±", en:"Al-Qahhar"}, {ar:"ÿßŸÑŸàŸáÿßÿ®", en:"Al-Wahhab"}, {ar:"ÿßŸÑÿ±ÿ≤ÿßŸÇ", en:"Ar-Razzaq"}, {ar:"ÿßŸÑŸÅÿ™ÿßÿ≠", en:"Al-Fattah"}, {ar:"ÿßŸÑÿπŸÑŸäŸÖ", en:"Al-Alim"}, {ar:"ÿßŸÑŸÇÿßÿ®ÿ∂", en:"Al-Qabid"}, {ar:"ÿßŸÑÿ®ÿßÿ≥ÿ∑", en:"Al-Basit"}, {ar:"ÿßŸÑÿÆÿßŸÅÿ∂", en:"Al-Khafid"}, {ar:"ÿßŸÑÿ±ÿßŸÅÿπ", en:"Ar-Rafi"}, {ar:"ÿßŸÑŸÖÿπÿ≤", en:"Al-Mu'izz"}, {ar:"ÿßŸÑŸÖÿ∞ŸÑ", en:"Al-Mudhill"}, {ar:"ÿßŸÑÿ≥ŸÖŸäÿπ", en:"As-Sami"}, {ar:"ÿßŸÑÿ®ÿµŸäÿ±", en:"Al-Basir"}, {ar:"ÿßŸÑÿ≠ŸÉŸÖ", en:"Al-Hakam"}, {ar:"ÿßŸÑÿπÿØŸÑ", en:"Al-Adl"}, {ar:"ÿßŸÑŸÑÿ∑ŸäŸÅ", en:"Al-Latif"}, {ar:"ÿßŸÑÿÆÿ®Ÿäÿ±", en:"Al-Khabir"}, {ar:"ÿßŸÑÿ≠ŸÑŸäŸÖ", en:"Al-Halim"}, {ar:"ÿßŸÑÿπÿ∏ŸäŸÖ", en:"Al-Azim"}, {ar:"ÿßŸÑÿ∫ŸÅŸàÿ±", en:"Al-Ghafur"}, {ar:"ÿßŸÑÿ¥ŸÉŸàÿ±", en:"Ash-Shakur"}, {ar:"ÿßŸÑÿπŸÑŸä", en:"Al-Ali"}, {ar:"ÿßŸÑŸÉÿ®Ÿäÿ±", en:"Al-Kabir"}, {ar:"ÿßŸÑÿ≠ŸÅŸäÿ∏", en:"Al-Hafiz"}, {ar:"ÿßŸÑŸÖŸÇŸäÿ™", en:"Al-Muqit"}, {ar:"ÿßŸÑÿ≠ÿ≥Ÿäÿ®", en:"Al-Hasib"}, {ar:"ÿßŸÑÿ¨ŸÑŸäŸÑ", en:"Al-Jalil"}, {ar:"ÿßŸÑŸÉÿ±ŸäŸÖ", en:"Al-Karim"}, {ar:"ÿßŸÑÿ±ŸÇŸäÿ®", en:"Ar-Raqib"}, {ar:"ÿßŸÑŸÖÿ¨Ÿäÿ®", en:"Al-Mujib"}, {ar:"ÿßŸÑŸàÿßÿ≥ÿπ", en:"Al-Wasi"}, {ar:"ÿßŸÑÿ≠ŸÉŸäŸÖ", en:"Al-Hakim"}, {ar:"ÿßŸÑŸàÿØŸàÿØ", en:"Al-Wadud"}, {ar:"ÿßŸÑŸÖÿ¨ŸäÿØ", en:"Al-Majid"}, {ar:"ÿßŸÑÿ®ÿßÿπÿ´", en:"Al-Ba'ith"}, {ar:"ÿßŸÑÿ¥ŸáŸäÿØ", en:"Ash-Shahid"}, {ar:"ÿßŸÑÿ≠ŸÇ", en:"Al-Haqq"}, {ar:"ÿßŸÑŸàŸÉŸäŸÑ", en:"Al-Wakil"}, {ar:"ÿßŸÑŸÇŸàŸä", en:"Al-Qawiy"}, {ar:"ÿßŸÑŸÖÿ™ŸäŸÜ", en:"Al-Matin"}, {ar:"ÿßŸÑŸàŸÑŸä", en:"Al-Wali"}, {ar:"ÿßŸÑÿ≠ŸÖŸäÿØ", en:"Al-Hamid"}, {ar:"ÿßŸÑŸÖÿ≠ÿµŸä", en:"Al-Muhsi"}, {ar:"ÿßŸÑŸÖÿ®ÿØÿ¶", en:"Al-Mubdi"}, {ar:"ÿßŸÑŸÖÿπŸäÿØ", en:"Al-Mu'id"}, {ar:"ÿßŸÑŸÖÿ≠ŸäŸä", en:"Al-Muhyi"}, {ar:"ÿßŸÑŸÖŸÖŸäÿ™", en:"Al-Mumit"}, {ar:"ÿßŸÑÿ≠Ÿä", en:"Al-Hayy"}, {ar:"ÿßŸÑŸÇŸäŸàŸÖ", en:"Al-Qayyum"}, {ar:"ÿßŸÑŸàÿßÿ¨ÿØ", en:"Al-Wajid"}, {ar:"ÿßŸÑŸÖÿßÿ¨ÿØ", en:"Al-Majid"}, {ar:"ÿßŸÑŸàÿßÿ≠ÿØ", en:"Al-Wahid"}, {ar:"ÿßŸÑÿ£ÿ≠ÿØ", en:"Al-Ahad"}, {ar:"ÿßŸÑÿµŸÖÿØ", en:"As-Samad"}, {ar:"ÿßŸÑŸÇÿßÿØÿ±", en:"Al-Qadir"}, {ar:"ÿßŸÑŸÖŸÇÿ™ÿØÿ±", en:"Al-Muqtadir"}, {ar:"ÿßŸÑŸÖŸÇÿØŸÖ", en:"Al-Muqaddim"}, {ar:"ÿßŸÑŸÖÿ§ÿÆÿ±", en:"Al-Mu'akhkhir"}, {ar:"ÿßŸÑÿ£ŸàŸÑ", en:"Al-Awwal"}, {ar:"ÿßŸÑÿ¢ÿÆÿ±", en:"Al-Akhir"}, {ar:"ÿßŸÑÿ∏ÿßŸáÿ±", en:"Az-Zahir"}, {ar:"ÿßŸÑÿ®ÿßÿ∑ŸÜ", en:"Al-Batin"}, {ar:"ÿßŸÑŸàÿßŸÑŸä", en:"Al-Wali"}, {ar:"ÿßŸÑŸÖÿ™ÿπÿßŸÑŸä", en:"Al-Muta'ali"}, {ar:"ÿßŸÑÿ®ÿ±", en:"Al-Barr"}, {ar:"ÿßŸÑÿ™Ÿàÿßÿ®", en:"At-Tawwab"}, {ar:"ÿßŸÑŸÖŸÜÿ™ŸÇŸÖ", en:"Al-Muntaqim"}, {ar:"ÿßŸÑÿπŸÅŸà", en:"Al-Afu"}, {ar:"ÿßŸÑÿ±ÿ§ŸàŸÅ", en:"Ar-Ra'uf"}, {ar:"ŸÖÿßŸÑŸÉ ÿßŸÑŸÖŸÑŸÉ", en:"Malik-ul-Mulk"}, {ar:"ÿ∞Ÿà ÿßŸÑÿ¨ŸÑÿßŸÑ ŸàÿßŸÑÿ•ŸÉÿ±ÿßŸÖ", en:"Zul-Jalali wal-Ikram"}, {ar:"ÿßŸÑŸÖŸÇÿ≥ÿ∑", en:"Al-Muqsit"}, {ar:"ÿßŸÑÿ¨ÿßŸÖÿπ", en:"Al-Jami"}, {ar:"ÿßŸÑÿ∫ŸÜŸä", en:"Al-Ghani"}, {ar:"ÿßŸÑŸÖÿ∫ŸÜŸä", en:"Al-Mughni"}, {ar:"ÿßŸÑŸÖÿßŸÜÿπ", en:"Al-Mani"}, {ar:"ÿßŸÑÿ∂ÿßÿ±", en:"Ad-Darr"}, {ar:"ÿßŸÑŸÜÿßŸÅÿπ", en:"An-Nafi"}, {ar:"ÿßŸÑŸÜŸàÿ±", en:"An-Nur"}, {ar:"ÿßŸÑŸáÿßÿØŸä", en:"Al-Hadi"}, {ar:"ÿßŸÑÿ®ÿØŸäÿπ", en:"Al-Badi"}, {ar:"ÿßŸÑÿ®ÿßŸÇŸä", en:"Al-Baqi"}, {ar:"ÿßŸÑŸàÿßÿ±ÿ´", en:"Al-Warith"}, {ar:"ÿßŸÑÿ±ÿ¥ŸäÿØ", en:"Ar-Rashid"}, {ar:"ÿßŸÑÿµÿ®Ÿàÿ±", en:"As-Sabur"}
        ];

        const wisdoms = ["Indeed, with hardship comes ease (94:6).", "The best among you are those who learn the Quran and teach it.", "So remember Me; I will remember you (2:152).", "A smile is charity.", "Allah does not burden a soul beyond that it can bear.", "Kindness is a mark of faith.", "The strong is not the one who overcomes people, but the one who controls his anger.", "Trust in Allah, but tie your camel.", "Allah loves those who turn to Him in repentance.", "Speak a good word or remain silent.", "Forgive others as you would like Allah to forgive you.", "Your only limit is your soul.", "He who has no mercy will receive no mercy.", "Prayer is better than sleep.", "Truthfulness leads to righteousness.", "Modesty is part of faith.", "Allah is beautiful and loves beauty.", "Upper hand is better than the lower hand.", "Be in this world as a stranger.", "Righteousness is good character.", "Avoid jealousy.", "The best Jihad is truth to a tyrant.", "Cleanliness is half of faith.", "Every act of kindness is charity.", "Allah is with the patient.", "Fear Allah wherever you are.", "Riches are from a contented mind.", "Follow a bad deed with a good one.", "Paradise lies at the feet of mothers.", "A father gives nothing better than manners.", "Silence is wisdom.", "Be patient for the Promise of Allah is true.", "Do not despair of the mercy of Allah.", "Good manners are the heaviest on the scale.", "The dunya is a prison for the believer.", "Sadaqah extinguishes sin like water extinguishes fire.", "Make dua, it is the weapon of the believer.", "Read Quran, for it comes as an intercessor.", "Stay close to Allah and He will stay close to you.", "Gratitude increases blessings.", "Anger begins with madness and ends with regret.", "Be like the flower that gives its fragrance to even the hand that crushes it."];

        const quizBank = [
            {q:"Who is the first Prophet?", a:["Adam (AS)","Nuh (AS)","Idris (AS)"], c:0}, {q:"How many Rakats in Fajr Fard?", a:["4","2","3"], c:1}, {q:"Which month comes after Ramadan?", a:["Shawwal","Rajab","Dhul-Hijjah"], c:0}, {q:"Who was the foster mother of Muhammad (PBUH)?", a:["Aminah","Halimah","Khadijah"], c:1}, {q:"Which Surah is the 'Heart of Quran'?", a:["Al-Mulk","Ya-Sin","Ar-Rahman"], c:1}, {q:"How many Juz are in the Quran?", a:["30","25","114"], c:0}, {q:"First Caliph of Islam?", a:["Umar (RA)","Abu Bakr (RA)","Ali (RA)"], c:1}, {q:"Where was Muhammad (PBUH) born?", a:["Mecca","Madinah","Taif"], c:0}, {q:"What is the word for 'Oneness of God'?", a:["Zakat","Tawhid","Iman"], c:1}, {q:"How many times is Bismillah in the Quran?", a:["113","114","115"], c:1}, {q:"Which Angel brings Revelation?", a:["Mika'il","Jibril","Israfil"], c:1}, {q:"Direction of prayer is called?", a:["Mihrab","Qibla","Minaret"], c:1}, {q:"Prophet who spoke in infancy?", a:["Musa (AS)","Isa (AS)","Ibrahim (AS)"], c:1}, {q:"What is the night of power?", a:["Laylatul Qadr","Laylatul Mi'raj","Eid"], c:0}, {q:"How many years did the Quran take to reveal?", a:["10","40","23"], c:2}, {q:"Who will blow the Trumpet?", a:["Azra'il","Israfil","Ridwan"], c:1}, {q:"Longest Surah in Quran?", a:["An-Nisa","Al-Baqarah","Al-Ma'idah"], c:1}, {q:"How many Prophets are mentioned in Quran?", a:["100","25","50"], c:1}, {q:"Wife of Ibrahim (AS) and mother of Ismail (AS)?", a:["Sarah","Hajar","Asiya"], c:1}, {q:"Battle where Muslims were outnumbered 3:1?", a:["Badr","Uhud","Khandaq"], c:0}, {q:"First word revealed of the Quran?", a:["Islam","Iqra","Salam"], c:1}, {q:"Which Prophet built the Ark?", a:["Nuh (AS)","Hud (AS)","Salih (AS)"], c:0}, {q:"The Prophet's migration to Madinah is?", a:["Hajj","Hijrah","Umrah"], c:1}, {q:"Surah without Bismillah?", a:["At-Tawbah","An-Namal","Al-Fajr"], c:0}, {q:"The Prophet's horse-like creature for Mi'raj?", a:["Buraq","Camel","Ababil"], c:0}, {q:"Who killed Jalut (Goliath)?", a:["Suleiman (AS)","Dawud (AS)","Musa (AS)"], c:1}, {q:"What is Az-Zakat?", a:["Fast","Prayer","Charity"], c:2}, {q:"Number of gates in Jannah?", a:["7","8","9"], c:1}, {q:"Number of levels in Jahannam?", a:["7","8","9"], c:0}, {q:"Language of the Quran?", a:["Persian","Urdu","Arabic"], c:2}, {q:"Prophet swallowed by a whale?", a:["Yunus (AS)","Yusuf (AS)","Ayyub (AS)"], c:0}, {q:"The 10th day of Muharram?", a:["Eid","Ashura","Arafat"], c:1}, {q:"Who is the 'Seal of the Prophets'?", a:["Isa (AS)","Muhammad (PBUH)","Ibrahim (AS)"], c:1}, {q:"Which Prophet could talk to animals?", a:["Dawud (AS)","Suleiman (AS)","Adam (AS)"], c:1}, {q:"Total number of Surahs?", a:["114","110","120"], c:0}, {q:"Which is the shortest Surah?", a:["Al-Ikhlas","Al-Kawthar","Al-Asr"], c:1}, {q:"Who are the 'Hafiz'?", a:["Givers","Memorizers","Teachers"], c:1}, {q:"What is 'Sujud'?", a:["Standing","Prostration","Sitting"], c:1}, {q:"Prophet whose beauty was legendary?", a:["Yusuf (AS)","Isa (AS)","Musa (AS)"], c:0}, {q:"What is the 'Sunnah'?", a:["Quran","Prophetic Way","History"], c:1}, {q:"Prophet who survived the fire?", a:["Ibrahim (AS)","Nuh (AS)","Lut (AS)"], c:0}, {q:"Who is the enemy of believers?", a:["Firaun","Shaytan","Qarun"], c:1}, {q:"Day of Gathering is?", a:["Friday","Yawm al-Qiyamah","Saturday"], c:1}, {q:"What is 'Sabr'?", a:["Peace","Patience","Love"], c:1}, {q:"Prophet given the Zabur?", a:["Dawud (AS)","Musa (AS)","Isa (AS)"], c:0}, {q:"Month of Hajj?", a:["Ramadan","Dhul-Hijjah","Muharram"], c:1}, {q:"What is 'Halal'?", a:["Forbidden","Permissible","Doubtful"], c:1}, {q:"How many daughters did the Prophet have?", a:["2","4","1"], c:1}, {q:"Who was the first Muezzin?", a:["Bilal (RA)","Zayd (RA)","Hamza (RA)"], c:0}, {q:"Where did the Prophet receive first revelation?", a:["Cave Hira","Cave Thawr","Kaaba"], c:0}
        ];

        // 3. LOGIC & FUNCTIONS
        let userData = JSON.parse(localStorage.getItem('alsa_v10')) || { coins: 0, lastClaimDate: "", claimedSalah: [], tasbih: 0 };

        function save() { 
            localStorage.setItem('alsa_v10', JSON.stringify(userData));
            document.getElementById('coinCount').innerText = userData.coins;
            const user = auth.currentUser;
            if (user) {
                db.ref('leaderboard/' + user.uid).set({ name: user.displayName, coins: userData.coins, lastUpdated: firebase.database.ServerValue.TIMESTAMP });
            }
        }

        function countTasbih() {
            userData.tasbih++;
            if (navigator.vibrate) navigator.vibrate(20);
            if(userData.tasbih % 33 === 0) { userData.coins += 1; showCoinAnimation(); }
            document.getElementById('tasbihDisplay').innerText = userData.tasbih;
            save();
        }
        function resetTasbih() { userData.tasbih = 0; document.getElementById('tasbihDisplay').innerText = 0; save(); }
        
        // PANEL TRANSITIONS
        function toggleMenu() { 
            let m = document.getElementById('fullMenu'); 
            if(m.style.display === 'flex') { m.classList.remove('panel-active'); setTimeout(() => m.style.display = 'none', 400); }
            else { m.style.display = 'flex'; setTimeout(() => m.classList.add('panel-active'), 10); }
        }
        function openTasbih() { toggleMenu(); openPanel('tasbihPanel'); }
        function openSurahs() { toggleMenu(); openPanel('surahPanel'); }
        function openQuiz() { if(document.getElementById('fullMenu').style.display==='flex') toggleMenu(); openPanel('quizPanel'); loadNewQuestion(); }
        
        function openPanel(id) {
            const p = document.getElementById(id);
            p.style.display = 'flex'; setTimeout(() => p.classList.add('panel-active'), 10);
        }
        function closeTasbih() { closePanel('tasbihPanel'); }
        function closeSurahs() { closePanel('surahPanel'); }
        function closeQuiz() { closePanel('quizPanel'); }
        function closePanel(id) {
            const p = document.getElementById(id);
            p.classList.remove('panel-active'); setTimeout(() => p.style.display = 'none', 400);
        }

        // COMING SOON POPUP LOGIC
        function showComingSoon() {
            toggleMenu(); // Close menu first
            const pop = document.getElementById('comingSoonPopup');
            pop.style.display = 'block';
            setTimeout(() => pop.classList.add('active'), 10);
        }
        function closeComingSoon() {
            const pop = document.getElementById('comingSoonPopup');
            pop.classList.remove('active');
            setTimeout(() => pop.style.display = 'none', 300);
        }

        async function fetchPrayerTimes() {
            try {
                const pos = await new Promise((res, rej) => navigator.geolocation.getCurrentPosition(res, rej));
                const res = await fetch(`https://api.aladhan.com/v1/timings?latitude=${pos.coords.latitude}&longitude=${pos.coords.longitude}&method=2`);
                const data = await res.json();
                const times = data.data.timings;
                document.getElementById('t-fajr').innerText = times.Fajr;
                document.getElementById('t-dhuhr').innerText = times.Dhuhr;
                document.getElementById('t-asr').innerText = times.Asr;
                document.getElementById('t-maghrib').innerText = times.Maghrib;
                document.getElementById('t-isha').innerText = times.Isha;
                document.getElementById('t-sunrise').innerText = times.Sunrise;
                document.getElementById('locationLabel').innerText = "Prayer Times (Live)";
            } catch (e) {
                document.getElementById('locationLabel').innerText = "Prayer Times (Default)";
            }
        }

        function handleGoogleLogin() {
            const provider = new firebase.auth.GoogleAuthProvider();
            auth.signInWithPopup(provider).then((result) => {
                db.ref('leaderboard/' + result.user.uid).once('value').then((snapshot) => {
                    if (snapshot.exists()) { userData.coins = snapshot.val().coins || 0; save(); }
                });
                updateUI(result.user);
            }).catch(err => alert("Login Error: " + err.message));
        }
        function handleLogout() { auth.signOut().then(() => updateUI(null)); }
        
        function updateUI(user) {
            const nameEl = document.getElementById('userNameDisplay');
            const loginBtn = document.getElementById('loginBtn');
            const logoutBtn = document.getElementById('logoutBtn');
            if (user) {
                nameEl.innerText = "SALAM, " + user.displayName;
                loginBtn.style.display = "none"; logoutBtn.style.display = "flex";
                save();
            } else {
                nameEl.innerText = ""; loginBtn.style.display = "flex"; logoutBtn.style.display = "none";
            }
            renderLeaderboard();
        }
        auth.onAuthStateChanged(updateUI);

        function checkDailyReset() {
            const today = new Date().toDateString();
            if (userData.lastClaimDate !== today) { userData.lastClaimDate = today; userData.claimedSalah = []; save(); }
            document.querySelectorAll('.mission-btn').forEach(btn => {
                const id = btn.id.split('-')[1];
                if(userData.claimedSalah.includes(id)) btn.classList.add('done');
            });
        }
        function completeSalah(id, btn) {
            if(userData.claimedSalah.includes(id)) return;
            userData.coins += 1; userData.claimedSalah.push(id);
            btn.classList.add('done'); showCoinAnimation(); save();
        }
        function showCoinAnimation() {
            const el = document.getElementById('coinFeedback');
            el.classList.remove('animate-coin'); void el.offsetWidth; el.classList.add('animate-coin');
        }

        // UPGRADED LEADERBOARD RENDER
        function renderLeaderboard() {
            const lbBody = document.getElementById('leaderboardBody');
            db.ref('leaderboard').orderByChild('coins').limitToLast(10).on('value', (snapshot) => {
                let leaders = [];
                snapshot.forEach((child) => { leaders.push(child.val()); });
                leaders.reverse();
                if (leaders.length === 0) {
                    lbBody.innerHTML = "<tr><td colspan='3' style='text-align:center; padding:20px; opacity:0.5;'>Login to see Global Leaders</td></tr>";
                    return;
                }
                lbBody.innerHTML = leaders.map((leader, index) => {
                    // Logic updated: Top 3 get medals, rest get plain numbers
                    let badge = index + 1;
                    if(index === 0) badge = "ü•á";
                    if(index === 1) badge = "ü•à";
                    if(index === 2) badge = "ü•â";
                    
                    return `<tr><td class="rank-cell">${badge}</td><td>${leader.name || "Anonymous"}</td><td style="text-align:right">${(leader.coins || 0).toLocaleString()} ü™ô</td></tr>`;
                }).join('');
            });
        }

        function loadNewQuestion() {
            const rand = quizBank[Math.floor(Math.random() * quizBank.length)];
            document.getElementById('questionText').innerText = rand.q;
            const container = document.getElementById('optionsContainer');
            container.innerHTML = "";
            rand.a.forEach((opt, i) => { container.innerHTML += `<button class="quiz-opt" onclick="checkQuiz(${i}, ${rand.c}, this)">${opt}</button>`; });
        }
        function checkQuiz(choice, correct, btn) {
            if(choice === correct) {
                btn.style.background = "#34c759"; btn.style.color = "white";
                userData.coins += 1; showCoinAnimation(); save();
                setTimeout(loadNewQuestion, 800);
            } else {
                btn.style.background = "#ff3b30"; btn.style.color = "white";
                setTimeout(() => { btn.style.background = "#f2f2f7"; btn.style.color = "var(--emerald)"; }, 500);
            }
        }

        function updateTimers() {
            const now = new Date();
            const ram = new Date("Feb 18, 2026 00:00:00").getTime();
            const dR = ram - now.getTime();
            document.getElementById('ramadan').innerText = Math.max(0, Math.floor(dR/(1000*60*60*24))) + "d " + Math.max(0, Math.floor((dR%(1000*60*60*24))/(1000*60*60))) + "h";
            let jum = new Date(now); jum.setDate(now.getDate() + (5 - now.getDay() + 7) % 7); jum.setHours(13, 30, 0, 0);
            const dJ = jum.getTime() - now.getTime();
            document.getElementById('jummah').innerText = Math.floor(dJ/(1000*60*60*24)) + "d " + Math.floor((dJ%(1000*60*60*24))/(1000*60*60)) + "h";
        }

        window.onload = () => {
            checkDailyReset(); fetchPrayerTimes(); renderLeaderboard(); updateTimers();
            document.getElementById('tasbihDisplay').innerText = userData.tasbih;
            setInterval(updateTimers, 60000);
            
            // GENERATE 50 SURAHS
            const sList = document.getElementById('surahList');
            for(let i=1; i<=50; i++) {
                let id = i.toString().padStart(3, '0');
                let name = surahNames[i-1] || `Surah ${i}`;
                sList.innerHTML += `<div class="surah-card"><div class="surah-info"><b>${i}. ${name}</b><span class="surah-name-ar">ÿ≥Ÿàÿ±ÿ©</span></div><audio controls preload="none" src="https://server8.mp3quran.net/afs/${id}.mp3"></audio></div>`;
            }

            // GENERATE 100 WISDOMS IN SLIDEBAR
            const qList = document.getElementById('quoteList');
            for(let i=1; i<=100; i++) {
                let text = wisdoms[(i-1) % wisdoms.length]; // Looping through array to get 100 items
                qList.innerHTML += `<div class="q-card"><p>"${text}"</p><span>‚Äî Wisdom #${i}</span></div>`;
            }

            // GENERATE 99 NAMES
            const nGrid = document.getElementById('namesGrid');
            allahNames.forEach(n => {
                nGrid.innerHTML += `<div class="name-box"><span class="ar">${n.ar}</span><span class="en">${n.en}</span></div>`;
            });
        };
    </script>
</body>
</html>
