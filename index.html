<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Al-Alsa | Global Ummah</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Inter:wght@400;600;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-font-smoothing: antialiased; }
        :root { --emerald: #043927; --gold: #c5a021; --bg: #f2f2f7; --white: #ffffff; --ai-green: #2ecc71; }
        
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: #121212; line-height: 1.4; }

        /* --- Navigation --- */
        nav { background: var(--emerald); padding: 16px 20px; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .logo { font-weight: 900; font-size: 1.5rem; color: var(--gold); letter-spacing: -0.5px; }

        /* --- Overlays --- */
        #fullMenu, #surahPanel, #quizPanel {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--emerald); z-index: 5000; display: none; flex-direction: column;
            overflow-y: auto; padding: 60px 25px;
        }
        .menu-item { color: white; text-decoration: none; font-size: 1.6rem; margin: 12px 0; font-weight: 800; cursor: pointer; transition: 0.2s; }
        .close-btn { position: absolute; top: 20px; right: 25px; color: white; font-size: 2.2rem; cursor: pointer; }

        /* --- Hero --- */
        .hero { background: linear-gradient(180deg, var(--emerald) 0%, #0a5c41 100%); color: white; padding: 50px 20px; text-align: center; border-bottom-left-radius: 40px; border-bottom-right-radius: 40px; }
        .timer-row { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 30px; }
        .timer-card { background: rgba(255,255,255,0.08); padding: 18px; border-radius: 24px; border: 1px solid rgba(255,255,255,0.15); backdrop-filter: blur(5px); }
        .timer-card small { font-size: 0.7rem; font-weight: 800; text-transform: uppercase; color: rgba(255,255,255,0.7); display: block; margin-bottom: 4px; }
        .timer-card b { font-size: 1.1rem; color: var(--gold); font-weight: 900; }

        /* --- Layout --- */
        .container { padding: 20px; max-width: 650px; margin: -40px auto 0; position: relative; z-index: 10; }
        section { background: var(--white); padding: 25px; border-radius: 28px; margin-bottom: 20px; box-shadow: 0 12px 35px rgba(0,0,0,0.05); }
        h2 { font-size: 1.25rem; font-weight: 900; color: var(--emerald); margin-bottom: 18px; display: flex; align-items: center; gap: 10px; }

        /* --- Shahin AI --- */
        #voice-trigger { 
            position: fixed; bottom: 30px; right: 25px; background: var(--ai-green); color: white; border: none; 
            padding: 14px 24px; border-radius: 50px; box-shadow: 0 12px 30px rgba(46, 204, 113, 0.4); 
            cursor: pointer; z-index: 8000; display: flex; align-items: center; gap: 12px; font-weight: 800; font-size: 0.9rem;
        }
        #ai-status { 
            position: fixed; bottom: 95px; right: 25px; background: white; padding: 20px; border-radius: 24px; 
            font-weight: 700; font-size: 0.9rem; box-shadow: 0 15px 40px rgba(0,0,0,0.2); 
            display: none; z-index: 8000; border-left: 5px solid var(--ai-green); width: 260px;
        }

        /* --- 99 Names --- */
        .names-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
        .name-box { background: #fbfbfd; padding: 16px; border-radius: 20px; text-align: center; border: 1px solid #f0f0f5; transition: 0.3s; }
        .name-box .ar { font-family: 'Amiri'; font-size: 1.6rem; color: var(--emerald); display: block; margin-bottom: 4px; }
        .name-box .en { font-size: 0.75rem; font-weight: 800; color: var(--gold); text-transform: uppercase; letter-spacing: 0.5px; }

        /* --- Wisdoms --- */
        .quote-scroll { height: 350px; overflow-y: auto; padding-right: 8px; }
        .q-card { padding: 20px 0; border-bottom: 1px solid #f0f0f5; }
        .q-card p { font-size: 0.95rem; font-weight: 600; color: #2c3e50; line-height: 1.5; margin-bottom: 8px; }
        .q-card span { font-size: 0.7rem; color: var(--gold); font-weight: 900; text-transform: uppercase; }

        /* --- Quran List --- */
        .surah-card { background: rgba(255,255,255,0.08); padding: 18px; border-radius: 20px; margin-bottom: 15px; border: 1px solid rgba(255,255,255,0.1); }
        .surah-card b { color: var(--gold); font-size: 1.1rem; display: block; margin-bottom: 8px; font-weight: 800; }
        audio { width: 100%; height: 36px; filter: invert(0.9); opacity: 0.8; }

        /* --- Utilities --- */
        .mission-btn { width: 100%; padding: 18px; margin-bottom: 12px; border-radius: 20px; border: none; background: #f2f2f7; font-weight: 800; color: var(--emerald); cursor: pointer; display: flex; justify-content: space-between; align-items: center; transition: 0.3s; }
        .mission-btn.done { background: #34c759; color: white; }
    </style>
</head>
<body>

    <div id="ai-status"></div>
    <button id="voice-trigger" onclick="startVoiceAI()">
        <i class="fas fa-microphone-lines"></i> SHAHIN AI
    </button>

    <nav>
        <div class="logo">AL-ALSA</div>
        <div style="display: flex; gap: 12px; align-items: center;">
            <div style="font-weight: 900; background: var(--gold); color: #000; padding: 6px 14px; border-radius: 14px; font-size: 0.85rem; box-shadow: 0 4px 10px rgba(197, 160, 33, 0.3);">ğŸª™ <span id="coinCount">0</span></div>
            <div onclick="toggleMenu()" style="color:white; cursor:pointer; padding: 5px;"><i class="fas fa-bars-staggered" style="font-size: 1.4rem;"></i></div>
        </div>
    </nav>

    <div id="fullMenu">
        <div class="close-btn" onclick="toggleMenu()">Ã—</div>
        <div id="userNameDisplay" style="color: var(--gold); font-size: 1rem; font-weight: 900; text-align: center; margin-bottom: 30px;"></div>
        <div class="menu-item" id="loginBtn" onclick="handleGoogleLogin()"><i class="fab fa-google"></i> Google Login</div>
        <div class="menu-item" onclick="openSurahs()"><i class="fas fa-headphones"></i> Listen Quran</div>
        <div class="menu-item" onclick="openQuiz()"><i class="fas fa-brain"></i> Islamic Quiz</div>
        <div class="menu-item" id="logoutBtn" onclick="handleLogout()" style="display:none; color: #ff3b30; margin-top: 40px; font-size: 1.2rem;"><i class="fas fa-power-off"></i> Logout</div>
    </div>

    <div id="surahPanel">
        <div class="close-btn" onclick="closeSurahs()">Ã—</div>
        <h2 style="color:var(--gold); margin-bottom: 30px; justify-content: center;">Noble Quran</h2>
        <div id="surahList"></div>
    </div>
    
    <div id="quizPanel">
        <div class="close-btn" onclick="closeQuiz()">Ã—</div>
        <h2 style="color:var(--gold); justify-content: center;">Quiz Challenge</h2>
        <div id="quizBox" style="margin-top:40px;">
            <p id="questionText" style="color:white; font-size:1.3rem; font-weight:800; text-align:center; margin-bottom:25px;"></p>
            <div id="optionsContainer"></div>
        </div>
    </div>

    <div class="hero">
        <h1 style="font-family: 'Amiri'; font-size: 2.8rem; color: var(--gold); text-shadow: 0 4px 10px rgba(0,0,0,0.2);">Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„Ù‡Ù</h1>
        <p style="font-weight: 800; letter-spacing: 1px; font-size: 0.8rem; opacity: 0.9;">THE DIGITAL COMPANION FOR THE UMMAH</p>
        <div class="timer-row">
            <div class="timer-card"><small>Ramadan 2026</small><b id="ramadanTimer">--d --h</b></div>
            <div class="timer-card"><small>Friday Prayer</small><b id="jummahTimer">--d --h</b></div>
        </div>
    </div>

    <div class="container">
        <section>
            <h2><i class="fas fa-user-circle"></i> Developer</h2>
            <p style="font-size: 0.95rem; font-weight: 600; color: #444; border-left: 4px solid var(--gold); padding-left: 15px;">I am <b>Shahin Aktar</b>, a 17-year-old visionary developer. <b>Al-Alsa</b> is my mission to blend high-end technology with Islamic values for the Global Ummah.</p>
        </section>

        <section id="missions">
            <h2><i class="fas fa-check-double"></i> Salah Tracker</h2>
            <button class="mission-btn" id="btn-fajr" onclick="complete(this, 'fajr')">FAJR <span>+1 ğŸª™</span></button>
            <button class="mission-btn" id="btn-dhuhr" onclick="complete(this, 'dhuhr')">DHUHR <span>+1 ğŸª™</span></button>
            <button class="mission-btn" id="btn-asr" onclick="complete(this, 'asr')">ASR <span>+1 ğŸª™</span></button>
            <button class="mission-btn" id="btn-maghrib" onclick="complete(this, 'maghrib')">MAGHRIB <span>+1 ğŸª™</span></button>
            <button class="mission-btn" id="btn-isha" onclick="complete(this, 'isha')">ISHA <span>+1 ğŸª™</span></button>
        </section>

        <section>
            <h2><i class="fas fa-star"></i> 99 Names of Allah</h2>
            <div class="names-grid" id="namesGrid"></div>
        </section>

        <section>
            <h2><i class="fas fa-book-open"></i> 100 Wisdoms & Verses</h2>
            <div class="quote-scroll" id="quoteList"></div>
        </section>
    </div>

    <script>
        // --- DATA ---
        // Expanded to 99 Unique items
        const ALLAH_NAMES = [
            ["Ø§Ù„Ù„Ù‡","Allah"],["Ø§Ù„Ø±Ø­Ù…Ù†","Ar-Rahman"],["Ø§Ù„Ø±Ø­ÙŠÙ…","Ar-Rahim"],["Ø§Ù„Ù…Ù„Ùƒ","Al-Malik"],["Ø§Ù„Ù‚Ø¯ÙˆØ³","Al-Quddus"],["Ø§Ù„Ø³Ù„Ø§Ù…","As-Salam"],["Ø§Ù„Ù…Ø¤Ù…Ù†","Al-Mu'min"],["Ø§Ù„Ù…Ù‡ÙŠÙ…Ù†","Al-Muhaymin"],["Ø§Ù„Ø¹Ø²ÙŠØ²","Al-Aziz"],["Ø§Ù„Ø¬Ø¨Ø§Ø±","Al-Jabbar"],["Ø§Ù„Ù…ØªÙƒØ¨Ø±","Al-Mutakabbir"],["Ø§Ù„Ø®Ø§Ù„Ù‚","Al-Khaliq"],["Ø§Ù„Ø¨Ø§Ø±Ø¦","Al-Bari"],["Ø§Ù„Ù…ØµÙˆØ±","Al-Musawwir"],["Ø§Ù„ØºÙØ§Ø±","Al-Ghaffar"],["Ø§Ù„Ù‚Ù‡Ø§Ø±","Al-Qahhar"],["Ø§Ù„ÙˆÙ‡Ø§Ø¨","Al-Wahhab"],["Ø§Ù„Ø±Ø²Ø§Ù‚","Ar-Razzaq"],["Ø§Ù„ÙØªØ§Ø­","Al-Fattah"],["Ø§Ù„Ø¹Ù„ÙŠÙ…","Al-Alim"],
            ["Ø§Ù„Ù‚Ø§Ø¨Ø¶","Al-Qabid"],["Ø§Ù„Ø¨Ø§Ø³Ø·","Al-Basit"],["Ø§Ù„Ø®Ø§ÙØ¶","Al-Khafid"],["Ø§Ù„Ø±Ø§ÙØ¹","Ar-Rafi"],["Ø§Ù„Ù…Ø¹Ø²","Al-Mu'izz"],["Ø§Ù„Ù…Ø°Ù„","Al-Mudhill"],["Ø§Ù„Ø³Ù…ÙŠØ¹","As-Sami"],["Ø§Ù„Ø¨ØµÙŠØ±","Al-Basir"],["Ø§Ù„Ø­ÙƒÙŠÙ…","Al-Hakim"],["Ø§Ù„Ø¹Ø¯Ù„","Al-Adl"],["Ø§Ù„Ù„Ø·ÙŠÙ","Al-Latif"],["Ø§Ù„Ø®Ø¨ÙŠØ±","Al-Khabir"],["Ø§Ù„Ø­Ù„ÙŠÙ…","Al-Halim"],["Ø§Ù„Ø¹Ø¸ÙŠÙ…","Al-Azim"],["Ø§Ù„ØºÙÙˆØ±","Al-Ghafoor"],["Ø§Ù„Ø´ÙƒÙˆØ±","Ash-Shakur"],["Ø§Ù„Ø¹Ù„ÙŠ","Al-Ali"],["Ø§Ù„ÙƒØ¨ÙŠØ±","Al-Kabir"],["Ø§Ù„Ø­ÙÙŠØ¸","Al-Hafiz"],["Ø§Ù„Ù…Ù‚ÙŠØª","Al-Muqit"],
            ["Ø§Ù„Ø­Ø³ÙŠØ¨","Al-Hasib"],["Ø§Ù„Ø¬Ù„ÙŠÙ„","Al-Jalil"],["Ø§Ù„ÙƒØ±ÙŠÙ…","Al-Karim"],["Ø§Ù„Ø±Ù‚ÙŠØ¨","Ar-Raqib"],["Ø§Ù„Ù…Ø¬ÙŠØ¨","Al-Mujib"],["Ø§Ù„ÙˆØ§Ø³Ø¹","Al-Wasi"],["Ø§Ù„Ø­ÙƒÙŠÙ…","Al-Hakim"],["Ø§Ù„ÙˆØ¯ÙˆØ¯","Al-Wadud"],["Ø§Ù„Ù…Ø¬ÙŠØ¯","Al-Majid"],["Ø§Ù„Ø¨Ø§Ø¹Ø«","Al-Ba'ith"],["Ø§Ù„Ø´Ù‡ÙŠØ¯","Ash-Shahid"],["Ø§Ù„Ø­Ù‚","Al-Haqq"],["Ø§Ù„ÙˆÙƒÙŠÙ„","Al-Wakil"],["Ø§Ù„Ù‚ÙˆÙŠ","Al-Qawiyy"],["Ø§Ù„Ù…ØªÙŠÙ†","Al-Matin"],["Ø§Ù„ÙˆÙ„ÙŠ","Al-Wali"],["Ø§Ù„Ø­Ù…ÙŠØ¯","Al-Hamid"],["Ø§Ù„Ù…Ø­ØµÙŠ","Al-Muhsi"],["Ø§Ù„Ù…Ø¨Ø¯Ø¦","Al-Mubdi"],["Ø§Ù„Ù…Ø¹ÙŠØ¯","Al-Mu'id"],
            ["Ø§Ù„Ù…Ø­ÙŠÙŠ","Al-Muhyi"],["Ø§Ù„Ù…Ù…ÙŠØª","Al-Mumit"],["Ø§Ù„Ø­ÙŠ","Al-Hayy"],["Ø§Ù„Ù‚ÙŠÙˆÙ…","Al-Qayyum"],["Ø§Ù„ÙˆØ§Ø¬Ø¯","Al-Wajid"],["Ø§Ù„Ù…Ø§Ø¬Ø¯","Al-Majid"],["Ø§Ù„ÙˆØ§Ø­Ø¯","Al-Wahid"],["Ø§Ù„Ø£Ø­Ø¯","Al-Ahad"],["Ø§Ù„ØµÙ…Ø¯","As-Samad"],["Ø§Ù„Ù‚Ø§Ø¯Ø±","Al-Qadir"],["Ø§Ù„Ù…Ù‚ØªØ¯Ø±","Al-Muqtadir"],["Ø§Ù„Ù…Ù‚Ø¯Ù…","Al-Muqaddim"],["Ø§Ù„Ù…Ø¤Ø®Ø±","Al-Mu'akhkhir"],["Ø§Ù„Ø£ÙˆÙ„","Al-Awwal"],["Ø§Ù„Ø¢Ø®Ø±","Al-Akhir"],["Ø§Ù„Ø¸Ø§Ù‡Ø±","Az-Zahir"],["Ø§Ù„Ø¨Ø§Ø·Ù†","Al-Batin"],["Ø§Ù„ÙˆØ§Ù„ÙŠ","Al-Wali"],["Ø§Ù„Ù…ØªØ¹Ø§Ù„ÙŠ","Al-Muta'ali"],["Ø§Ù„Ø¨Ø±","Al-Barr"],
            ["Ø§Ù„ØªÙˆØ§Ø¨","At-Tawwab"],["Ø§Ù„Ù…Ù†ØªÙ‚Ù…","Al-Muntaqim"],["Ø§Ù„Ø¹ÙÙˆ","Al-Afu"],["Ø§Ù„Ø±Ø¤ÙˆÙ","Ar-Ra'uf"],["Ù…Ø§Ù„Ùƒ Ø§Ù„Ù…Ù„Ùƒ","Malik-ul-Mulk"],["Ø°Ùˆ Ø§Ù„Ø¬Ù„Ø§Ù„ ÙˆØ§Ù„Ø¥ÙƒØ±Ø§Ù…","Zul-Jalal-wal-Ikram"],["Ø§Ù„Ù…Ù‚Ø³Ø·","Al-Muqsit"],["Ø§Ù„Ø¬Ø§Ù…Ø¹","Al-Jami"],["Ø§Ù„ØºÙ†ÙŠ","Al-Ghani"],["Ø§Ù„Ù…ØºÙ†ÙŠ","Al-Mughni"],["Ø§Ù„Ù…Ø§Ù†Ø¹","Al-Mani"],["Ø§Ù„Ø¶Ø§Ø±","Ad-Darr"],["Ø§Ù„Ù†Ø§ÙØ¹","An-Nafi"],["Ø§Ù„Ù†ÙˆØ±","An-Nur"],["Ø§Ù„Ù‡Ø§Ø¯ÙŠ","Al-Hadi"],["Ø§Ù„Ø¨Ø¯ÙŠØ¹","Al-Badi"],["Ø§Ù„Ø¨Ø§Ù‚ÙŠ","Al-Baqi"],["Ø§Ù„ÙˆØ§Ø±Ø«","Al-Warith"],["Ø§Ù„Ø±Ø´ÙŠØ¯","Ar-Rashid"],["Ø§Ù„ØµØ¨ÙˆØ±","As-Sabur"]
        ];

        // 100 UNIQUE WISDOMS
        const WISDOMS = [
            "Actions are judged by intentions.", "The best of you are those who learn the Quran and teach it.", "Patience is a pillar of faith.", "Kindness is a mark of faith.", "Speak a good word or remain silent.", "A smile is charity.", "Cleanliness is half of faith.", "Paradise lies at the feet of mothers.", "Do not get angry.", "God is with the patient.",
            "Trust in Allah, but tie your camel.", "The strong man is not the wrestler, but the one who controls his anger.", "Feed the hungry and visit the sick.", "Save yourself from Hellfire even with half a date.", "Richness is not having many possessions, but richness of soul.", "None of you truly believes until he loves for his brother what he loves for himself.", "Seek knowledge from the cradle to the grave.", "The ink of the scholar is more holy than the blood of the martyr.", "He who does not thank people, does not thank Allah.", "Allah is beautiful and loves beauty.",
            "Modesty brings nothing but good.", "The world is a prison for the believer and a paradise for the disbeliever.", "Be in this world as if you were a stranger.", "Take advantage of five before five: your youth before old age...", "Giving charity does not decrease wealth.", "Fear Allah wherever you are.", "Follow a bad deed with a good deed.", "The most beloved deed to Allah is the most regular and constant.", "Gentleness adorns everything.", "Oppression will be darkness on the Day of Judgment.",
            "A good word is a charity.", "Every act of kindness is charity.", "Do not spy on one another.", "Do not backbite one another.", "The believer is not a slanderer.", "Allah helps the servant as long as the servant helps his brother.", "Whoever believes in Allah and the Last Day should honor his guest.", "Making peace between two people is charity.", "Removing a harmful object from the road is charity.", "Cheerfulness towards your brother is charity.",
            "The best of people are those most beneficial to others.", "Seek forgiveness, for Allah is Forgiving.", "Mercy is only removed from a miserable person.", "Allah is Gentle and loves gentleness.", "Do not waste water even if you were at a running stream.", "Pay the worker his wages before his sweat dries.", "Avoid suspicion.", "Jealousy eats away at good deeds like fire eats wood.", "The upper hand is better than the lower hand.", "A father gives his child nothing better than good manners.",
            "There is no disease that Allah has created, except that He also has created its treatment.", "Supplication is the essence of worship.", "The key to Paradise is prayer.", "The key to prayer is purification.", "Truthfulness leads to righteousness.", "Lying leads to wickedness.", "A hypocrite has three signs: when he speaks he lies...", "Do not sever ties of kinship.", "Treat your neighbors well.", "Respect your elders and have mercy on the young.",
            "Allah does not look at your appearance, but at your hearts.", "Your body has a right over you.", "Your family has a right over you.", "Give gifts, you will love one another.", "The best Jihad is a word of truth before a tyrant ruler.", "Knowledge is light.", "Ignorance is darkness.", "With hardship comes ease.", "Indeed, Allah is with those who fear Him.", "My mercy encompasses all things.",
            "Call upon Me; I will respond to you.", "Establish prayer for My remembrance.", "Read in the name of your Lord.", "And speak to people good words.", "Do not walk on the earth arrogantly.", "Lower your voice.", "Be grateful to Me and do not deny Me.", "Indeed, prayer prohibits immorality and wrongdoing.", "Hold firmly to the rope of Allah.", "And consult them in the matter.",
            "Forgive and overlook.", "Repel evil with that which is better.", "Allah loves the doers of good.", "Allah loves the patient.", "Allah loves those who trust in Him.", "Allah loves the just.", "Allah loves the purifyers.", "Allah does not love the aggressors.", "Allah does not love the arrogant.", "Allah is the Light of the heavens and the earth.",
            "To Allah belongs the east and the west.", "Wherever you turn, there is the Face of Allah.", "He is the First and the Last.", "He is with you wherever you are.", "Sufficient for us is Allah.", "Upon Allah let the believers rely.", "If you are grateful, I will surely increase you.", "My Lord, increase me in knowledge.", "Our Lord, give us in this world good.", "Peace be upon you."
        ];

        // --- CORE LOGIC ---
        function runTimers() {
            const now = new Date();
            const ramadan = new Date("February 18, 2026 00:00:00").getTime();
            const diff = ramadan - now.getTime();
            document.getElementById("ramadanTimer").innerText = Math.floor(diff/(1000*60*60*24)) + "d " + Math.floor((diff%(1000*60*60*24))/(1000*60*60)) + "h";
            
            let dToF = (5 - now.getDay() + 7) % 7;
            document.getElementById("jummahTimer").innerText = dToF === 0 ? "Today" : dToF + " Days";
        }
        setInterval(runTimers, 60000); runTimers();

        const synth = window.speechSynthesis;
        function aiResponse(text) {
            const status = document.getElementById('ai-status');
            status.style.display = 'block';
            status.innerHTML = `<span style="color:var(--ai-green); font-size:0.7rem;">SHAHIN AI RESPONDING...</span><br>${text}`;
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.pitch = 1; utterance.rate = 1;
            synth.speak(utterance);
            setTimeout(() => status.style.display = 'none', 6000);
        }

        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        function startVoiceAI() {
            recognition.start();
            const s = document.getElementById('ai-status');
            s.style.display = 'block'; s.innerText = "I'm listening, Shahin...";
        }

        recognition.onresult = (e) => {
            const cmd = e.results[0][0].transcript.toLowerCase();
            if(cmd.includes("surah") || cmd.includes("quran")) { aiResponse("Opening the Quran player for you."); openSurahs(); }
            else if(cmd.includes("quiz")) { aiResponse("Starting the Islamic quiz. Good luck!"); openQuiz(); }
            else if(cmd.includes("who are you")) { aiResponse("I am Shahin AI, the digital brain of Al Alsa, built by Shahin Aktar."); }
            else aiResponse("I understood: " + cmd + ". Try saying 'Open Quran' or 'Start Quiz'.");
        };

        window.onload = () => {
            checkDailyReset();

            // Fill 99 Names
            const nGrid = document.getElementById('namesGrid');
            ALLAH_NAMES.forEach(pair => {
                nGrid.innerHTML += `<div class="name-box"><span class="ar">${pair[0]}</span><span class="en">${pair[1]}</span></div>`;
            });

            // Fill 100 Unique Wisdoms
            const qList = document.getElementById('quoteList');
            WISDOMS.forEach((txt, i) => {
                qList.innerHTML += `<div class="q-card"><p>"${txt}"</p><span>Verse/Wisdom #${i+1}</span></div>`;
            });

            // Surahs - Expanded to 50
            const surahs = [
                "Al-Fatiha", "Al-Baqarah", "Al-Imran", "An-Nisa", "Al-Ma'idah", "Al-An'am", "Al-A'raf", "Al-Anfal", "At-Tawbah", "Yunus",
                "Hud", "Yusuf", "Ar-Ra'd", "Ibrahim", "Al-Hijr", "An-Nahl", "Al-Isra", "Al-Kahf", "Maryam", "Ta-Ha",
                "Al-Anbiya", "Al-Hajj", "Al-Mu'minun", "An-Nur", "Al-Furqan", "Ash-Shu'ara", "An-Naml", "Al-Qasas", "Al-Ankabut", "Ar-Rum",
                "Luqman", "As-Sajdah", "Al-Ahzab", "Saba", "Fatir", "Ya-Sin", "As-Saffat", "Sad", "Az-Zumar", "Ghafir",
                "Fussilat", "Ash-Shura", "Az-Zukhruf", "Ad-Dukhan", "Al-Jathiyah", "Al-Ahqaf", "Muhammad", "Al-Fath", "Al-Hujurat", "Qaf"
            ];
            
            const sList = document.getElementById('surahList');
            surahs.forEach((name, i) => {
                sList.innerHTML += `<div class="surah-card"><b>${i+1}. ${name}</b><audio controls src="https://server8.mp3quran.net/afs/${(i+1).toString().padStart(3,'0')}.mp3"></audio></div>`;
            });
        };

        // --- APP STATE & DAILY LOGIC ---
        let appData = JSON.parse(localStorage.getItem('alsa_db')) || { coins: 0, date: "", claimed: [] };
        document.getElementById('coinCount').innerText = appData.coins;

        function checkDailyReset() {
            const today = new Date().toDateString(); // e.g. "Mon Feb 03 2026"
            if (appData.date !== today) {
                // New Day: Reset claimed missions
                appData.date = today;
                appData.claimed = []; 
                save();
            }
            // Restore button states
            appData.claimed.forEach(id => {
                const btn = document.getElementById('btn-' + id);
                if(btn) btn.classList.add('done');
            });
        }

        function toggleMenu() { const m = document.getElementById('fullMenu'); m.style.display = m.style.display === 'flex' ? 'none' : 'flex'; }
        function openSurahs() { toggleMenu(); document.getElementById('surahPanel').style.display = 'flex'; }
        function closeSurahs() { document.getElementById('surahPanel').style.display = 'none'; }
        function openQuiz() { toggleMenu(); document.getElementById('quizPanel').style.display = 'flex'; nextQ(); }
        function closeQuiz() { document.getElementById('quizPanel').style.display = 'none'; }

        function nextQ() {
            const questions = [{q:"Which Prophet built the Ark?", a:["Nuh (AS)","Ibrahim (AS)"], c:0}, {q:"What is the first month of Hijri?", a:["Ramadan","Muharram"], c:1}];
            const q = questions[Math.floor(Math.random()*questions.length)];
            document.getElementById('questionText').innerText = q.q;
            document.getElementById('optionsContainer').innerHTML = q.a.map((opt,i)=>`<button class="mission-btn" style="background:rgba(255,255,255,0.1); color:white; border:1px solid rgba(255,255,255,0.3);" onclick="ans(${i},${q.c},this)">${opt}</button>`).join('');
        }

        function ans(i,c,btn) {
            // Quiz coins are unlimited
            if(i===c) { btn.style.background="#34c759"; appData.coins+=5; save(); setTimeout(nextQ, 800); }
            else btn.style.background="#ff3b30";
        }

        // Modified Complete Function for Daily Reset
        function complete(btn, prayerId) { 
            // Check if already claimed today
            if(appData.claimed.includes(prayerId)) return;

            btn.classList.add('done'); 
            appData.coins += 10; 
            appData.claimed.push(prayerId);
            save(); 
        }

        function save() { 
            document.getElementById('coinCount').innerText = appData.coins; 
            localStorage.setItem('alsa_db', JSON.stringify(appData)); 
        }
    </script>
</body>
</html>
